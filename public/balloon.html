<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>é¢¨èˆ¹ã‚²ãƒ¼ãƒ </title>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <style>
    canvas {
      background: linear-gradient(#87CEFA, #ffffff);
      display: block;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <h1 style="text-align:center;">ğŸˆ Balloon Game</h1>
  <canvas id="gameCanvas" width="400" height="600"></canvas>

  <script>
    const socket = io();
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let balloonY = 300;
    let velocity = 0;
    let beta = 0;

    // ğŸŸ¢ "sensor" ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘å–ã‚‹ã‚ˆã†ã«å¤‰æ›´ï¼
    socket.on("sensor", (data) => {
      if (data && data.b) {
        beta = parseFloat(data.b);
      }
    });

    function update() {
      // å‚¾ãã«å¿œã˜ã¦ä¸Šä¸‹ã«å‹•ã
      velocity += -beta / 100;  // å€¤ãŒå¤§ãã„ã»ã©å‹•ãã‚„ã™ããªã‚‹
      velocity *= 0.9; // æ…£æ€§
      balloonY += velocity;

      if (balloonY < 50) balloonY = 50;
      if (balloonY > 550) balloonY = 550;
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // é¢¨èˆ¹ã®ã²ã‚‚
      ctx.beginPath();
      ctx.moveTo(200, balloonY + 40);
      ctx.lineTo(200, balloonY + 100);
      ctx.strokeStyle = "#555";
      ctx.stroke();

      // é¢¨èˆ¹æœ¬ä½“
      ctx.beginPath();
      ctx.arc(200, balloonY, 40, 0, Math.PI * 2);
      ctx.fillStyle = "pink";
      ctx.fill();
      ctx.stroke();
    }

    function loop() {
      update();
      draw();
      requestAnimationFrame(loop);
    }

    loop();
  </script>
</body>
</html>


